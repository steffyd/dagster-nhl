{
    "name": "Dagster Development",
    "build": {
        "dockerfile": "../Dockerfile_base",
        "args": {
            "DAGSTER_VERSION": "1.7.7"
        }
    },
    "extensions": [
        "ms-python.python",
        "ms-python.vscode-pylance"
    ],
    "features": {
        "ghcr.io/devcontainers/features/docker-in-docker:1": {
            "version": "latest"
        },
        "ghcr.io/devcontainers/features/git:1": {
            "version": "latest"
        }
    },
    "forwardPorts": [22],
    "mounts": [
        {
            "source": "${localEnv:HOME}/.ssh", 
            "target": "/home/vscode/.ssh",
            "type": "bind",
            "consistency": "cached",
            "condition": "localEnv:SSH_AUTH_SOCK"
        },
        {
            "source": "${localEnv:USERPROFILE}\\.ssh", 
            "target": "/home/vscode/.ssh",
            "type": "bind",
            "consistency": "cached",
            "condition": "!localEnv:SSH_AUTH_SOCK" 
        },
        {
            "source": "${localEnv:HOME}/Library/Containers/com.docker.docker/Data/database/com.docker.driver.amd64-linux/etc/docker/daemon.json", // macOS path
            "target": "/home/vscode/.docker/config.json",
            "type": "bind",
            "consistency": "cached",
            "condition": "localEnv:SSH_AUTH_SOCK" // Mount only if SSH_AUTH_SOCK is defined (macOS)
        },
        {
            "source": "${localEnv:USERPROFILE}\\.docker\\config.json", // Windows path
            "target": "/home/vscode/.docker/config.json",
            "type": "bind",
            "consistency": "cached",
            "condition": "!localEnv:SSH_AUTH_SOCK" // Mount only if SSH_AUTH_SOCK is NOT defined (Windows)
        }
    ]
}
